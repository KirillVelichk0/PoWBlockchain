cmake_minimum_required(VERSION 3.20)
project(BlockChainCore)

set(CMAKE_CXX_STANDARD 20)
set(CMAKE_EXPORT_COMPILE_COMMANDS ON)
find_program(CLANG_TIDY_EXE NAMS clang-tidy)
if(CLANG_TIDY_EXE)
    set(CMAKE_CXX_CLANG_TIDY ${CLANG_TIDY_EXE})
endif()

find_package(protobuf CONFIG REQUIRED)

#protobuf_generate_cpp(PROTO_SRCS PROTO_HDRS ./src/proto/BlockExternal.proto)
#add_library(BlockExternProto ${PROTO_SRCS} ${PROTO_HDRS})
find_package(Boost REQUIRED COMPONENTS random)
find_package(cryptopp CONFIG REQUIRED)
find_package(tl-expected CONFIG REQUIRED)
find_package(fmt CONFIG REQUIRED)
add_library(BlockExternProto ./src/proto/gen/BlockExternal.pb.h ./src/proto/gen/BlockExternal.pb.cc)
target_link_libraries(BlockExternProto public protobuf::libprotobuf)
add_library(BlockChainCore src/Block/Block.cpp src/Block/Block.h src/Crypto/Crypto.h src/Crypto/Crypto.cpp) 
target_link_libraries(BlockChainCore PRIVATE Boost::boost Boost::random cryptopp::cryptopp fmt::fmt tl::expected protobuf::libprotobuf )
